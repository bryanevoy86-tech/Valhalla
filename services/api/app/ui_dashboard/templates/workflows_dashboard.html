<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Automated Workflow Orchestration</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
      body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 2rem; color: #0f172a; }
      h1 { font-size: 1.5rem; margin-bottom: .5rem; }
      .card { border: 1px solid #e2e8f0; border-radius: .75rem; padding: 1rem; margin-top: 1rem; }
      .muted { color: #64748b; }
      input, select, button { padding: .5rem .75rem; border-radius: .5rem; border: 1px solid #cbd5e1; }
      button { background: #22c55e; color: white; border: none; cursor: pointer; }
      button:hover { background: #16a34a; }
      table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
      th, td { padding: .5rem; border-bottom: 1px solid #e2e8f0; text-align: left; }
      .badge { display: inline-block; background: #ecfeff; color: #0e7490; padding: .15rem .5rem; border-radius: 9999px; font-size: .75rem; }
    </style>
  </head>
  <body>
    <h1>Automated Workflow Orchestration</h1>
    <p class="muted">Submit and track automated tasks across the system.</p>

    <div class="card">
      <h2 style="font-size:1.1rem">Create Workflow</h2>
      <div style="display:flex; gap:.5rem; flex-wrap:wrap; margin-top:.5rem">
        <input id="task_name" placeholder="Task Name" />
        <select id="status">
          <option value="pending">pending</option>
          <option value="in_progress">in_progress</option>
          <option value="completed">completed</option>
          <option value="failed">failed</option>
        </select>
        <input id="result" placeholder="Result (optional)" />
        <button onclick="createWf()">Create</button>
      </div>
    </div>

    <div class="card">
      <h2 style="font-size:1.1rem">Workflows</h2>
      <table>
        <thead>
          <tr><th>Task</th><th>Status</th><th>Start</th><th>End</th><th>Result</th></tr>
        </thead>
        <tbody id="rows"></tbody>
      </table>
    </div>

    <script>
      const api = `${location.origin}/api/workflows`;
      async function refresh() {
        const res = await fetch(api);
        const data = await res.json();
        const tbody = document.getElementById('rows');
        tbody.innerHTML = '';
        for (const w of data) {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${w.task_name}</td><td><span class="badge">${w.status}</span></td><td>${w.start_time}</td><td>${w.end_time ?? ''}</td><td>${w.result ?? ''}</td>`;
          tbody.appendChild(tr);
        }
      }
      async function createWf() {
        const payload = {
          task_name: document.getElementById('task_name').value,
          status: document.getElementById('status').value,
          start_time: new Date().toISOString(),
          end_time: null,
          result: document.getElementById('result').value || null,
        };
        await fetch(api+'/', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
        await refresh();
      }
      refresh();
    </script>
  </body>
  </html>
