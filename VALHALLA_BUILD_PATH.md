# VALHALLA LEGACY â€” MASTER BUILD PATH

This document is the build playbook for the Valhalla / Heimdall system.

## 1. Layering

- **L0 â€” Foundations & Wiring**
  - Settings, environments, DB session
  - Security, auth, rate limiting
  - Tenants, users, staff
  - System health, logs, telemetry, tracing

- **L1 â€” Heimdall Brain & Guardrails**
  - Cognitive Layers (CL1â€“CL16) logic & tests
  - Strategic / Story / Scenario engines
  - Decision governance, system_tune, tuning_rules
  - Workflow_guardrails, triggers, telemetry

- **L2 â€” Empire & Money Systems**
  - Real estate: wholesale_deals, underwriting_engine, brrrr, rental_property, vehicle_tracking, truck_plan
  - Banking structure, tax_bridge, trust_residency, trust_status
  - saas_access, system_config, registration_navigator

- **L3 â€” Story / Family / Kids**
  - story_engine, story_mode, media_engine, education_engine
  - kids_education*, mental_load*, life_roles, life_timeline

- **L4 â€” Nice-to-Have / Expansion**
  - resort, pantry, king, blackice, advanced_negotiation, arbitrage, etc.

## 2. Progress Index Source

The canonical technical index lives in:

- `valhalla_manifest.json` (generated by valhalla_pack_tracker.py)

For each module entry:

- `status: "complete"` â†’ treat as **built**; only wire / harden.
- `status: "partial"` â†’ treat as **needs implementation / cleanup**.
- `status: "planned"` â†’ treat as **planned, not started**.

## 3. Build Rules

1. **Never** change DB models without either:
   - a migration file, or
   - a clear note: `# MIGRATION REQUIRED` in the model file.
2. **Routers** must always be registered in the main FastAPI app.
3. Every new **service** must have:
   - its own unit test file in `.../tests/`
   - basic logging and error handling.
4. If a module is in **status: complete**, only:
   - wire, refactor lightly, add tests, or fix bugs.
5. When finishing a **partial** module:
   - implement model / schema / service / router to match the pattern of similar COMPLETE modules (e.g. `system_health`, `trajectory`, `wholesale_deals`).
6. On every significant change:
   - update this file's "Next Build Steps" section.

## 4. Next Build Steps (live checklist)

**L0-01:** Create this file âœ…  
**L0-02:** Solidify settings + environment config âœ…  
**L0-03:** Lock in security & auth surface (no business logic yet) âœ…  
**L0-04:** Normalize user / tenant / staff "identity triangle" âœ…  
**L0-05:** Wire and harden system_health, system_status, system_log âœ…  
**L0-06:** Telemetry + Observability Wiring âœ…  
**L0-07:** Rate Limiting + Security Integration âœ…  
**L0-08:** Jobs, Schedulers & System Checks âœ…  
**L1-01+:** Heimdall brain (CL packs + governance) â€” see later section once L0 is stable.

_Update this list as we go._

## 5. PACK Completion Status

### L0 Foundation & Wiring âœ… COMPLETE (NEW)
- L0-01: Build Playbook âœ…
- L0-05: System Health/Status/Log âœ… (hardened)
- L0-06: Telemetry + Observability âœ… (new)
- L0-07: Rate Limiting + Security âœ… (integrated)
- L0-08: Jobs + Schedulers âœ… (new)

### Intelligence Subsystem (CI5-CI8) âœ… COMPLETE
- CI5: Tuning Ruleset Engine âœ…
- CI6: Trigger & Threshold Engine âœ…
- CI7: Strategic Mode Engine âœ…
- CI8: Narrative / Chapter Engine âœ…

### Control & Meta-Learning Subsystem (CL9-CL12) âœ… COMPLETE
- CL9: Decision Outcome Log & Feedback API âœ…
- CL11: Strategic Memory Timeline âœ…
- CL12: Model Provider Registry âœ…

### Planned (CL13-CL16) ðŸ“‹ READY FOR BUILD
- CL13: Prime Directive Engine (Projections, Variance, Bypass Protocols, PD Log)
- CL14: Capital Allocation Engine (Capital Lanes & Rules)
- CL15: System Blueprint Compiler (Blueprint + Version History)
- CL16: Pantheon Agent Registry & Routing Skeleton

---

**Last Updated:** December 7, 2025  
**Tracker:** `python valhalla_pack_tracker.py update` to sync latest status
