HEIMDALL_ADMIN_TOKEN=change-me-please
HEIMDALL_VIEWER_TOKEN=view-only-please
DISCORD_WEBHOOK_URL=
GENERIC_WEBHOOK_URL=
SMTP_USERNAME=
SMTP_PASSWORD=

OTEL_ENABLED=true
OTEL_SERVICE_NAME=valhalla-backend
OTEL_JSON_PATH=./traces.jsonl
OTEL_MAX_INMEM_SPANS=5000
OTEL_OTLP_ENABLED=true
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
OTEL_EXPORTER_OTLP_INSECURE=true

METRICS_ENABLED=true
METRICS_NAMESPACE=valhalla
METRICS_ROUTE_LAT_BUCKETS=0.005,0.01,0.025,0.05,0.1,0.25,0.5,1,2,5
LOG_ENABLED=true
LOG_LEVEL=INFO
TRIAGE_ENABLED=true
TRIAGE_PROM_URL=http://prometheus:9090
TRIAGE_GRAFANA_URL=http://grafana:3000
TRIAGE_TEMPO_URL=http://tempo:3200
TRIAGE_LOGS_URL_TMPL=

SCRUB_ENABLED=true
SCRUB_BODY_MAX_PREVIEW=8192
SCRUB_DENY_KEYS=password,passwd,secret,token,authorization,api_key,apikey,access_key,refresh_token,set-cookie,cookie,ssn,credit_card,card_number,cvv,x-api-key,x-auth-token,x-amz-security-token
SCRUB_ALLOW_KEYS=email,username
SCRUB_REPLACEMENT=***REDACTED***
SCRUB_PATTERNS=true
AM_SLACK_ENABLED=true
AM_SLACK_WEBHOOK_URL=https://hooks.slack.com/services/XXX/YYY/ZZZ
AM_SLACK_CHANNEL=#valhalla-incidents
AM_SLACK_USERNAME=ValhallaBot

AM_PD_ENABLED=false
AM_PD_ROUTING_KEY=changeme

GRAFANA_ANNOTATE_ENABLED=true
GRAFANA_ANNOTATE_URL=http://grafana:3000/api/annotations
GRAFANA_ANNOTATE_TOKEN=changeme

# ===== Canary core =====
CANARY_ENABLED=false
CANARY_UPSTREAM=http://backend-canary:8000
CANARY_PERCENT=0
CANARY_PATHS_REGEX=^/(io|public|api)(/.*)?$
CANARY_REQUIRE_HEADER=true
CANARY_STICKY_COOKIE=va_canary
CANARY_TIMEOUT_SECS=15

# Fail-safe: if proxy to canary fails this many times in a rolling window, auto-disable
CANARY_FAIL_BUDGET=10
CANARY_FAIL_WINDOW_SEC=120

# ===== Guardrails (Alertmanager â†’ auto adjust) =====
CANARY_GUARD_ENABLED=true
CANARY_GUARD_DROP_STEP=50
CANARY_GUARD_MIN_PERCENT=0
CANARY_GUARD_DISABLE_ON_SEVERE=true
CANARY_WEBHOOK_TOKEN=changeme

# Optional: persist state to disk (survives restarts)
CANARY_STATE_PATH=/data/canary_state.json

# Health Score Widget
HEALTH_ENABLED=true
HEALTH_WEIGHTS_P95=0.35
HEALTH_WEIGHTS_5XX=0.35
HEALTH_WEIGHTS_BURN=0.20
HEALTH_WEIGHTS_JOBS=0.10
HEALTH_REPORT_WINDOW_DAYS=7

# Blue/Green Switch
BG_ENABLED=true
BG_GREEN_UPSTREAM=http://backend-green:8000
BG_BLUE_UPSTREAM=http://backend:8000
BG_ACTIVE=blue
BG_DRAIN_SECONDS=60
BG_WARMUP_PATH=/health
BG_WARMUP_OK_SUBSTR=ok

# Feature-Flag Telemetry
FF_ENABLED=true

# Cost Observability
COST_ENABLED=true

# Security Audit Log
AUDIT_ENABLED=true

# Rate-Limiting Metrics
RL_ENABLED=true
RL_MAX_PER_MINUTE=600

# Cache Metrics
CACHE_ENABLED=true

# Backup/Restore Observability
BACKUP_ENABLED=true

# Multi-Tenant Tags
TENANT_TAG_ENABLED=true
TENANT_HEADER=X-Tenant-Id

# Cache Warmer Jobs
WARMER_ENABLED=true
WARMER_PATHS=/api/home,/api/pricing

# Synthetic Checks
SYN_ENABLED=true
SYN_TARGETS=https://valhalla.io,https://api.valhalla.io/health

# Auto-Silence
AUTO_SILENCE_ENABLED=true
AUTO_SILENCE_TTL=3600

# Data Retention & TTL
RETENTION_ENABLED=true
RETENTION_LOG_DAYS=14
RETENTION_TRACE_DAYS=7
RETENTION_REPLAY_DAYS=7
RETENTION_CRON_MINUTES=30

# Privacy Dashboard
PRIVACY_ENABLED=true
PRIVACY_USER_KEYS=email,user_id

# Chaos Toggles
CHAOS_ENABLED=false
CHAOS_LATENCY_MS=0
CHAOS_ERROR_RATE=0.0
CHAOS_PATHS_REGEX=^/api

# Compliance Evidence
EVIDENCE_ENABLED=true
EVIDENCE_PATH=/data/evidence.jsonl

# GeoIP
GEOIP_ENABLED=false
GEOIP_DB_PATH=/data/GeoLite2-Country.mmdb

# DB Observability
DBOBS_ENABLED=true
DBOBS_SLOW_SEC=0.3

# Queue Observability
QOBS_ENABLED=true

# Drift Detector
DRIFT_ENABLED=true

# Secret Scanner
SECSCAN_ENABLED=true
SECSCAN_MAX_LINES=2000
TENANT_SLO_ENABLED=true
TRACE_SAMPLE_RATE=0.1
AM_SLACK_WEBHOOK_URL=http://localhost/dummy
AM_SLACK_CHANNEL=general
AM_SLACK_USERNAME=alertbot
AM_PD_ROUTING_KEY=dummy-key
CANARY_WEBHOOK_TOKEN=dummy-token
LOG_SHIP_MODE=both
LOG_JSON_PATH=/data/app.jsonl
LOG_JSON_ROTATE_MB=20
LOG_JSON_BACKUPS=5
LOG_INCLUDE_HEADERS=false
VECTOR_ENABLED=true
VECTOR_DATA_DIR=/data/vector
VECTOR_LOG_PATH_GLOB=/data/app.jsonl*
VECTOR_TRACES_PATH_GLOB=/data/traces.jsonl*
VECTOR_HOSTNAME=valhalla-backend

# S3 sink (optional)
VECTOR_S3_ENABLE=true
VECTOR_S3_BUCKET=valhalla-logs
VECTOR_S3_REGION=us-east-1
VECTOR_S3_PREFIX=env/local/%Y/%m/%d/
AWS_ACCESS_KEY_ID=changeme
AWS_SECRET_ACCESS_KEY=changeme
AWS_SESSION_TOKEN=

# OpenSearch sink (optional)
VECTOR_OS_ENABLE=false
VECTOR_OS_ENDPOINT=http://opensearch:9200
VECTOR_OS_INDEX_PREFIX=valhalla-logs
VECTOR_OS_USER=admin
VECTOR_OS_PASS=admin

# Backpressure/retry tuning
VECTOR_BUFFER_MB=128
VECTOR_RETRY_MAX_ATTEMPTS=12
VECTOR_RETRY_INITIAL_BACKOFF_SECS=1
VECTOR_RETRY_MAX_BACKOFF_SECS=30
REPLAY_ENABLED=true
REPLAY_JSON_PATH=/data/replay.jsonl
REPLAY_MAX_BODY_KB=256
REPLAY_CAPTURE_STATUSES=500,502,503,504
REPLAY_SENSITIVE_HEADERS=authorization,cookie,set-cookie
REPLAY_ADMIN_TOKEN=changeme
REPLAY_DEFAULT_DEST=http://backend:8000
REPLAY_ALLOW_DEST_HOSTS=backend,localhost,127.0.0.1
REPLAY_TIMEOUT_SECS=20

# Ngrok public tunnel
NGROK_AUTHTOKEN=332VSrEV6MzXrtOOCmqGECD6dnE_33fRaywyQ1VPXJzeuwtF8
